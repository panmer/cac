(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{46:function(e,s,t){},47:function(e,s,t){},52:function(e,s,t){},56:function(e,s,t){},98:function(e,s,t){"use strict";t.r(s);t(45),t(46),t(47);var r=t(1),a=t(9),o=t.n(a),n=t(103),c=(t(52),t(0));const i=["User1","User2","User3","User4"];function l(e){let{onLogIn:s}=e;const[t,a]=Object(r.useState)((()=>i[Math.floor(Math.random()*i.length)])),[o,l]=Object(r.useState)(null),[m,u]=Object(r.useState)("password123");return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{className:"login-form text-center login-page",children:Object(c.jsxs)("div",{className:"rounded",style:{boxShadow:"0 0.75rem 1.5rem rgba(18,38,63,.03)"},children:[Object(c.jsxs)("div",{className:"position-relative",children:[Object(c.jsxs)("div",{className:"row no-gutters align-items-center",style:{maxWidth:400,backgroundColor:"palegreen",padding:20},children:[Object(c.jsxs)("div",{className:"col text-primary text-left",children:[Object(c.jsx)("h3",{className:"font-size-15",children:"Spring Redis Chat App!"}),Object(c.jsx)("i",{children:"This is a UI demo of the application"})]}),Object(c.jsx)("div",{className:"col align-self-end",children:Object(c.jsx)("img",{style:{maxWidth:"80%"},src:"".concat("","/welcome-back.png")})})]}),Object(c.jsx)("div",{className:"position-absolute",style:{bottom:-10,left:20}})]}),Object(c.jsxs)("form",{className:"bg-white text-left px-4",style:{paddingTop:20,borderBottomLeftRadius:4,borderBottomRightRadius:4},onSubmit:async e=>{e.preventDefault(),s(t,m,l)},children:[Object(c.jsx)("label",{className:"font-size-12",children:"Name"}),Object(c.jsx)("div",{className:"username-select mb-3",children:Object(c.jsx)(d,{username:t,setUsername:a,names:i})}),Object(c.jsx)("label",{htmlFor:"inputPassword",className:"font-size-12",children:"Password"}),Object(c.jsx)("input",{value:"password123",onChange:e=>u(e.target.value),type:"password",id:"inputPassword",className:"form-control",required:!0}),Object(c.jsx)("div",{style:{height:30}}),Object(c.jsx)("button",{className:"btn btn-lg btn-primary btn-block",type:"submit",children:"Sign in"}),Object(c.jsx)("div",{className:"login-error-anchor",children:Object(c.jsx)("div",{className:"toast-box",children:Object(c.jsxs)(n.a,{style:{minWidth:277},onClose:()=>l(null),show:null!==o,delay:3e3,autohide:!0,children:[Object(c.jsxs)(n.a.Header,{children:[Object(c.jsx)("img",{src:"holder.js/20x20?text=%20",className:"rounded mr-2",alt:""}),Object(c.jsx)("strong",{className:"mr-auto",children:"Error"})]}),Object(c.jsx)(n.a.Body,{children:o})]})})}),Object(c.jsx)("div",{style:{height:30}})]})]})})})}const d=e=>{var s;let{username:t,setUsername:a,names:o=[""]}=e;const[n,i]=Object(r.useState)(!1),[l,d]=Object(r.useState)(0),m=Object(r.useRef)(),u=null===(s=m.current)||void 0===s?void 0:s.getBoundingClientRect().width;return Object(r.useEffect)((()=>{d(u)}),[u]),Object(r.useEffect)((()=>{if(n){const e=()=>i(!1);return document.addEventListener("click",e),()=>document.removeEventListener("click",e)}}),[n]),Object(r.useEffect)((()=>{var e;n&&(null===(e=m.current)||void 0===e||e.focus())}),[n]),Object(c.jsxs)("div",{tabIndex:0,ref:m,className:"username-select-dropdown ".concat(n?"open":""),onClick:()=>i((e=>!e)),children:[Object(c.jsxs)("div",{className:"username-select-row",children:[Object(c.jsx)("div",{children:t}),Object(c.jsx)("div",{children:Object(c.jsx)("svg",{width:24,height:24,children:Object(c.jsx)("path",{d:"M7 10l5 5 5-5z",fill:"#333"})})})]}),Object(c.jsx)("div",{style:{width:l},className:"username-select-block ".concat(n?"open":""),children:o.map((e=>Object(c.jsx)("div",{className:"username-select-block-item",onClick:()=>a(e),children:e},e)))})]})};t(56);const m=(e,s)=>{switch(s.type){case"clear":return{currentRoom:"0",rooms:{},users:{}};case"set user":return{...e,users:{...e.users,[s.payload.id]:s.payload}};case"make user online":return{...e,users:{...e.users,[s.payload]:{...e.users[s.payload],online:!0}}};case"append users":return{...e,users:{...e.users,...s.payload}};case"set messages":return{...e,rooms:{...e.rooms,[s.payload.id]:{...e.rooms[s.payload.id],messages:s.payload.messages,offset:s.payload.messages.length}}};case"prepend messages":{const t=[...s.payload.messages,...e.rooms[s.payload.id].messages];return{...e,rooms:{...e.rooms,[s.payload.id]:{...e.rooms[s.payload.id],messages:t,offset:t.length}}}}case"append message":return void 0===e.rooms[s.payload.id]?e:{...e,rooms:{...e.rooms,[s.payload.id]:{...e.rooms[s.payload.id],lastMessage:s.payload.message,messages:e.rooms[s.payload.id].messages?[...e.rooms[s.payload.id].messages,s.payload.message]:void 0}}};case"set last message":return{...e,rooms:{...e.rooms,[s.payload.id]:{...e.rooms[s.payload.id],lastMessage:s.payload.lastMessage}}};case"set current room":return{...e,currentRoom:s.payload};case"add room":return{...e,rooms:{...e.rooms,[s.payload.id]:s.payload}};case"set rooms":{const t=s.payload,r={...e.rooms};return t.forEach((e=>{r[e.id]={...e,messages:r[e.id]&&r[e.id].messages}})),{...e,rooms:r}}default:return e}},u={currentRoom:"main",rooms:{},users:{}},j=Object(r.createContext)(),h=()=>{const[e,s]=Object(r.useContext)(j);return[e,s]};var b=()=>Object(r.useReducer)(m,u),g=t(8),x=t.n(g),p=t(18),O=t.n(p);O.a.defaults.withCredentials=!0;const f=function(e){return console.log("|||"+e+"|||"),JSON.parse(window.sessionStorage.getItem("allMessages"))[e]},v=(e,s)=>{for(let t of e)if("string"!==typeof t&&(t=t[0]),t!==s)return t;return e[0]},y=(t(76),async(e,s,t)=>{const r={};t.forEach((e=>{r[e.from]=1})),console.log("*************************8888888");const a=Object.keys(r).filter((s=>void 0===e[s]));if(0!==a.length){const e=await(e=>(console.log(JSON.stringify(e)),e.map((e=>{switch(e){case"1":return{id:1,username:"User1",isOnline:!1};case"2":return{id:2,username:"User2",isOnline:!1};case"3":return{id:3,username:"User3",isOnline:!1};case"4":return{id:4,username:"User4",isOnline:!1};default:throw new Error("Wrong Username")}}))))(a);s({type:"append users",payload:e})}});var w=()=>Object(c.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 1651 1651",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(c.jsx)("rect",{width:"1651",height:"1651",rx:"14",fill:"white"}),Object(c.jsx)("path",{d:"M495.286 1098.96L497.967 1070.86L478.04 1050.88C408.572 981.233 368 891.771 368 795.344C368 585.371 565.306 402 826 402C1086.69 402 1284 585.371 1284 795.344C1284 1005.32 1086.69 1188.69 826 1188.69V1248.69L825.913 1188.69C779.837 1188.75 733.952 1182.77 689.432 1170.9L667.26 1164.98L646.8 1175.37C620.731 1188.61 562.74 1213.98 467.32 1235.35C480.554 1191.83 490.95 1144.39 495.286 1098.96Z",stroke:"url(#paint0_linear)",strokeWidth:"120"}),Object(c.jsx)("defs",{children:Object(c.jsxs)("linearGradient",{id:"paint0_linear",x1:"662.312",y1:"397.956",x2:"416.164",y2:"1678.7",gradientUnits:"userSpaceOnUse",children:[Object(c.jsx)("stop",{stopColor:"#7514FB"}),Object(c.jsx)("stop",{offset:"0.624243",stopColor:"#F26D41"}),Object(c.jsx)("stop",{offset:"1",stopColor:"#F43B4B"})]})})]});var N=e=>{let{name:s,id:t}=e;const a=Object(r.useMemo)((()=>{const e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";const s=+e.split(":").pop();let t=+e.split(":").reverse().pop();t<0&&(t+=3555);const r=(654*s+531*t)%13;return"".concat("","/avatars/").concat(r,".jpg")}(""+t);return"User1"===s?"".concat("","/avatars/0.jpg"):"User2"===s?"".concat("","/avatars/2.jpg"):"User3"===s?"".concat("","/avatars/9.jpg"):"User4"===s?"".concat("","/avatars/8.jpg"):e}),[t,s]);return Object(c.jsx)(c.Fragment,{children:"General"!==s?Object(c.jsx)("img",{src:a,alt:s,style:{width:32,height:32,objectFit:"cover"},className:"rounded-circle avatar-xs"}):Object(c.jsx)("div",{className:"overflow-hidden rounded-circle",children:Object(c.jsx)(w,{})})})};var k=e=>{let{online:s,hide:t=!1,width:r=8,height:a=8}=e;return Object(c.jsx)("div",{className:s?"rounded-circle bg-success":"rounded-circle bg-gray",style:{width:r,height:a,opacity:t?0:1}})};const U=e=>{const{id:s,name:t}=e,[a]=h(),[o,n,c]=Object(r.useMemo)((()=>{try{let e=Math.abs(parseInt(s.split(":").reverse().pop()));const r=e>0,o=Object.entries(a.users).filter((e=>{let[,s]=e;return s.username===t})).map((e=>{let[,s]=e;return s}));let n=!1;return o.length>0&&(n=o[0].online,e=+o[0].id),[r,n,e]}catch(e){return[!1,!1,"0"]}}),[s,t,a.users]),i=C(e);return{isUser:o,online:n,userId:c,name:e.name,lastMessage:i}},C=e=>{const[,s]=h(),{lastMessage:t}=e;return Object(r.useEffect)((()=>{if(void 0===t)if(void 0===e.messages){let t=f(e.id,0,1),r=null;0!==t.length&&(r=t.pop()),s({type:"set last message",payload:{id:e.id,lastMessage:r}})}else 0===e.messages.length?s({type:"set last message",payload:{id:e.id,lastMessage:null}}):s({type:"set last message",payload:{id:e.id,lastMessage:e.messages[e.messages.length-1]}})}),[t,s,e]),t};var I=e=>{let{room:s,active:t=!1,onClick:r}=e;const{online:a,name:o,lastMessage:n,userId:i}=U(s);return Object(c.jsxs)("div",{onClick:r,className:"chat-list-item d-flex align-items-start rounded ".concat(t?"bg-white":""),children:[Object(c.jsx)("div",{className:"align-self-center mr-3",children:Object(c.jsx)(k,{online:a,hide:"0"===s.id})}),Object(c.jsx)("div",{className:"align-self-center mr-3",children:Object(c.jsx)(N,{name:o,id:i})}),Object(c.jsxs)("div",{className:"media-body overflow-hidden",children:[Object(c.jsx)("h5",{className:"text-truncate font-size-14 mb-1",children:o}),n&&Object(c.jsxs)("p",{className:"text-truncate mb-0",children:[" ",n.message," "]})]}),n&&Object(c.jsx)("div",{className:"font-size-11",children:x.a.unix(n.date).format("LT")})]})},L=t(101);const M=e=>{let{onLogOut:s,col:t=5,noinfo:r=!1}=e;return Object(c.jsxs)("div",{onClick:s,style:{cursor:"pointer"},className:"col-".concat(t," text-danger ").concat(r?"":"text-right"),children:[Object(c.jsx)(L.a,{})," Exit Chat"]})},S=e=>{let{user:s,col:t=7,noinfo:r=!1}=e;return Object(c.jsxs)("div",{className:"col-".concat(t," d-flex align-items-center ").concat(r?"justify-content-end":""),children:[Object(c.jsx)("div",{className:"align-self-center ".concat(r?"":"mr-3"),children:Object(c.jsx)(N,{name:s.username,id:s.id})}),!r&&Object(c.jsxs)("div",{className:"media-body",children:[Object(c.jsx)("h5",{className:"font-size-14 mt-0 mb-1",children:s.username}),Object(c.jsxs)("div",{className:"d-flex align-items-center",children:[Object(c.jsx)(k,{online:!0}),Object(c.jsx)("p",{className:"ml-2 text-muted mb-0",children:"Active"})]})]})]})};var E=e=>{let{user:s,onLogOut:t}=e;return Object(c.jsx)("div",{className:"row no-gutters align-items-center pl-4 pr-2 pb-3",style:{height:"inherit",flex:0,minHeight:50},children:Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(S,{user:s,col:8}),Object(c.jsx)(M,{onLogOut:t,col:4})]})})};var R=e=>{let{rooms:s,dispatch:t,user:a,currentRoom:o,onLogOut:n}=e;const i=Object(r.useMemo)((()=>{const e=Object.values(s),t=e.filter((e=>"0"===e.id));let r=e.filter((e=>"0"!==e.id));return r=r.sort(((e,s)=>+e.id.split(":").pop()-+s.id.split(":").pop())),[...t||[],...r]}),[s]);return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)("div",{className:"chat-list-container flex-column d-flex pr-4",children:[Object(c.jsx)("div",{className:"messages-box flex flex-1",children:Object(c.jsx)("div",{className:"list-group rounded-0",children:i.map((e=>Object(c.jsx)(I,{onClick:()=>t({type:"set current room",payload:e.id}),active:o===e.id,room:e},e.id)))})}),Object(c.jsx)("div",{className:"py-2",children:Object(c.jsx)("p",{className:"h5 mb-0 py-1 chats-title",children:"Chats"})}),Object(c.jsx)(E,{user:a,onLogOut:n})]})})};var _=e=>{let{message:s}=e;return Object(c.jsx)("p",{className:"mb-2 fs-6 fw-light fst-italic text-black-50 text-center",style:{opacity:.8,fontSize:14},children:s})};var T=()=>Object(c.jsx)("div",{className:"no-messages flex-column d-flex flex-row justify-content-center align-items-center text-muted text-center",children:Object(c.jsx)("div",{className:"spinner-border",role:"status",children:Object(c.jsx)("span",{className:"visually-hidden"})})}),z=t(102);var B=()=>Object(c.jsxs)("div",{className:"no-messages flex-column d-flex flex-row justify-content-center align-items-center text-muted text-center",children:[Object(c.jsx)(z.a,{size:96}),Object(c.jsx)("p",{children:"No messages"})]});var F=()=>Object(c.jsxs)("svg",{width:12,height:12,className:"prefix__MuiSvgIcon-root prefix__jss80 prefix__MuiSvgIcon-fontSizeLarge",viewBox:"0 0 24 24","aria-hidden":"true",children:[Object(c.jsx)("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),Object(c.jsx)("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]});var J=e=>{let{username:s="user",message:t="Lorem ipsum dolor...",date:r}=e;return Object(c.jsxs)("div",{className:"d-flex",children:[Object(c.jsx)("div",{style:{flex:1}}),Object(c.jsx)("div",{style:{width:"50%"},className:"text-right mb-4",children:Object(c.jsx)("div",{className:"conversation-list d-inline-block bg-light px-3 py-2",style:{borderRadius:12},children:Object(c.jsxs)("div",{className:"ctext-wrap",children:[Object(c.jsx)("div",{className:"conversation-name text-left text-primary mb-1",style:{fontWeight:600},children:s}),Object(c.jsx)("p",{className:"text-left",children:t}),Object(c.jsxs)("p",{className:"chat-time mb-0",children:[Object(c.jsx)(F,{})," ",x.a.unix(r).format("LT")," "]})]})})})]})};var W=e=>{let{user:s,message:t="Lorem ipsum dolor...",date:r,onUserClicked:a}=e;return Object(c.jsxs)("div",{className:"d-flex",children:[Object(c.jsx)("div",{style:{width:"50%"},className:"text-left mb-4",children:Object(c.jsx)("div",{className:"conversation-list d-inline-block px-3 py-2",style:{borderRadius:12,backgroundColor:"rgba(85, 110, 230, 0.1)"},children:Object(c.jsxs)("div",{className:"ctext-wrap",children:[s&&Object(c.jsxs)("div",{className:"conversation-name d-flex align-items-center mb-1",children:[Object(c.jsx)("div",{className:"mr-2",style:{fontWeight:600,cursor:"pointer",color:"green"},onClick:a,children:s.username}),Object(c.jsx)(k,{width:7,height:7,online:s.online})]}),Object(c.jsx)("p",{className:"text-left",children:t}),Object(c.jsxs)("p",{className:"chat-time mb-0",children:[Object(c.jsx)(F,{})," ",x.a.unix(r).format("LT")," "]})]})})}),Object(c.jsx)("div",{style:{flex:1}})]})};var A=e=>{let{messageListElement:s,messages:t,room:r,onLoadMoreMessages:a,user:o,onUserClicked:n,users:i}=e;return Object(c.jsxs)("div",{ref:s,className:"chat-box-wrapper position-relative d-flex",children:[void 0===t?Object(c.jsx)(T,{}):0===t.length?Object(c.jsx)(B,{}):Object(c.jsx)(c.Fragment,{}),Object(c.jsx)("div",{className:"px-4 pt-5 chat-box position-absolute",children:t&&0!==t.length&&Object(c.jsxs)(c.Fragment,{children:[r.offset&&r.offset>=10?Object(c.jsxs)("div",{className:"d-flex flex-row align-items-center mb-4",children:[Object(c.jsx)("div",{style:{height:1,backgroundColor:"#eee",flex:1}}),Object(c.jsx)("div",{className:"mx-3",children:Object(c.jsx)("button",{"aria-haspopup":"true","aria-expanded":"true",type:"button",onClick:a,className:"btn rounded-button btn-secondary nav-btn",id:"__BVID__168__BV_toggle_",children:"Load more"})}),Object(c.jsx)("div",{style:{height:1,backgroundColor:"#eee",flex:1}})]}):Object(c.jsx)(c.Fragment,{}),t.map(((e,s)=>{const t=e.message+e.date+e.from+s;return"info"===e.from?Object(c.jsx)(_,{message:e.message},t):+e.from!==+o.id?Object(c.jsx)(W,{onUserClicked:()=>n(e.from),message:e.message,date:e.date,user:i[e.from]},t):Object(c.jsx)(J,{username:i[e.from]?i[e.from].username:"",message:e.message,date:e.date},t)}))]})})]})};var G=e=>{let{message:s,setMessage:t,onSubmit:r}=e;return Object(c.jsx)("div",{className:"p-3 chat-input-section",children:Object(c.jsxs)("form",{className:"row",onSubmit:r,children:[Object(c.jsx)("div",{className:"col",children:Object(c.jsx)("div",{className:"position-relative",children:Object(c.jsx)("input",{value:s,onChange:e=>t(e.target.value),type:"text",placeholder:"Chat Here...",className:"form-control chat-input"})})}),Object(c.jsx)("div",{className:"col-auto",children:Object(c.jsxs)("button",{type:"submit",className:"btn btn-primary btn-rounded chat-send w-md",children:[Object(c.jsx)("span",{className:"d-none d-sm-inline-block mr-2",children:"Send"}),Object(c.jsx)("svg",{width:13,height:13,viewBox:"0 0 24 24",tabIndex:-1,children:Object(c.jsx)("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",fill:"white"})})]})})]})})};var D=e=>{console.log("*************************66666666666666");const[s,t]=h(),a=Object(r.useRef)(null),o=s.rooms[s.currentRoom],n=null===o||void 0===o?void 0:o.id,c=null===o||void 0===o?void 0:o.messages,[i,l]=Object(r.useState)(""),d=Object(r.useCallback)((()=>{setTimeout((()=>{a.current&&(a.current.scrollTop=0)}),0)}),[]),m=Object(r.useCallback)((()=>{a.current&&a.current.scrollTo({top:a.current.scrollHeight})}),[]);Object(r.useEffect)((()=>{m()}),[c,m]);const u=Object(r.useCallback)((function(){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=f(n,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0);y(s.users,t,r),t({type:e?"prepend messages":"set messages",payload:{id:n,messages:r}}),e?setTimeout((()=>{d()}),10):m()}),[t,n,m,d,s.users]);Object(r.useEffect)((()=>{void 0!==n&&void 0===c&&u()}),[c,t,n,s.users,s,m,u]),Object(r.useEffect)((()=>{a.current&&m()}),[m,n]);return{onLoadMoreMessages:Object(r.useCallback)((()=>{u(o.offset,!0)}),[u,o]),onUserClicked:async e=>{},message:i,setMessage:l,dispatch:t,room:o,rooms:s.rooms,currentRoom:s.currentRoom,messageListElement:a,roomId:n,users:s.users,messages:c}};function H(e){let{onLogOut:s,user:t,onMessageSend:r}=e;const{onLoadMoreMessages:a,onUserClicked:o,message:n,setMessage:i,rooms:l,room:d,currentRoom:m,dispatch:u,messageListElement:j,roomId:h,messages:b,users:g}=D(t);return Object(c.jsx)("div",{className:"container py-4 px-5",children:Object(c.jsxs)("div",{className:"chat-body row overflow-hidden shadow bg-light rounded",children:[Object(c.jsxs)("div",{className:"col-8 px-0 flex-column bg-white rounded-lg",children:[Object(c.jsx)("div",{className:"px-4 py-4",style:{borderBottom:"1px solid green"},children:Object(c.jsx)("h2",{className:"font-size-15 mb-0",children:d?d.name:"Chat Room"})}),Object(c.jsx)(A,{messageListElement:j,messages:b,room:d,onLoadMoreMessages:a,user:t,onUserClicked:o,users:g}),Object(c.jsx)(G,{message:n,setMessage:i,onSubmit:e=>{e.preventDefault(),r(n.trim(),h),i(""),j.current.scrollTop=j.current.scrollHeight}})]}),Object(c.jsx)("div",{className:"col-4 px-0",children:Object(c.jsx)(R,{user:t,onLogOut:s,rooms:l,currentRoom:m,dispatch:u})})]})})}function P(){return Object(c.jsx)("div",{className:"centered-box",children:Object(c.jsx)("div",{className:"spinner-border",role:"status",children:Object(c.jsx)("span",{className:"visually-hidden"})})})}var V=e=>{let{showLogin:s}=e;return Object(c.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light d-flex justify-content-between",children:[Object(c.jsx)("span",{className:"navbar-brand",children:"Chat Application"}),s?Object(c.jsx)("a",{href:"https://https://github.com/trungIsOnGithhub",children:"Github"}):Object(c.jsx)(c.Fragment,{})]})};const q=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>{};const[s,t]=Object(r.useState)(!0),[a,o]=Object(r.useState)(null);return Object(r.useEffect)((()=>{s&&(()=>{return O.a.get((e="/users/me","".concat("http://localhost:8080").concat(e))).then((e=>(console.log(JSON.stringify("Me : "+e.data)),e.data))).catch((e=>null));var e})().then((s=>{o(s),t(!1),e(s)}))}),[e,s]),{user:"string"===typeof a?null:a,onLogIn:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};(arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){})(null),t(!0),o(((e,s)=>{if("password123"!==s)throw new Error("Wrong Password");switch(e){case"User1":return{id:1,username:"User1",isOnline:!0};case"User2":return{id:2,username:"User2",isOnline:!0};case"User3":return{id:3,username:"User3",isOnline:!0};case"User4":return{id:4,username:"User4",isOnline:!0};default:throw new Error("Wrong Username")}})(e,s))},onLogOut:async()=>{o(null)},loading:s}};t(77);const X=()=>{const[e,s]=b(),t=Object(r.useCallback)((t=>{null!==t&&(e.users[t.id]||s({type:"set user",payload:{...t,online:!0}}))}),[s,e.users]),{user:a,onLogIn:o,onLogOut:n,loading:c}=q(t,s),[i,l,d]=((e,s,t)=>{const[a,o]=Object(r.useState)(!1),n=(Object(r.useRef)(null),Object(r.useCallback)((async(t,r)=>(console.log("]]]]]]"+JSON.stringify(t)),console.log("]]]]]]"+JSON.stringify(e)),console.log("]]]]]]"+JSON.stringify(r)),s({type:"append message",payload:{id:void 0===r.roomId?"0":r.roomId,message:r}}),{})),[e])),c=Object(r.useCallback)((async()=>{await n("user.disconnected",e),t()}),[t,n,e]);return[{emit:n},a,c]})(a,s,n);Object(r.useEffect)((()=>{if(null!==a)if(l){const t=[];Object.keys(e.rooms).forEach((s=>{const r=e.rooms[s];r.connected||t.push({...r,connected:!0})})),0!==t.length&&s({type:"set rooms",payload:t})}else{const t=[];Object.keys(e.rooms).forEach((s=>{const r=e.rooms[s];r.connected&&t.push({...r,connected:!1})})),0!==t.length&&s({type:"set rooms",payload:t})}}),[a,l,s,i,e.rooms,e.users]),Object(r.useEffect)((()=>{if(0===Object.values(e.rooms).length&&null!==a){let e=(e=>{switch(console.log(typeof e),e){case 2:return[{id:"2:3",names:["User2","User3"]},{id:"1:2",names:["User1","User2"]},{id:"2:4",names:["User2","User4"]},{id:"0",names:["General"]}];case 1:return[{id:"1:2",names:["User1","User2"]},{id:"1:3",names:["User1","User3"]},{id:"1:4",names:["User1","User4"]},{id:"0",names:["General"]}];case 3:return[{id:"3:4",names:["User3","User4"]},{id:"2:4",names:["User2","User4"]},{id:"1:4",names:["User1","User4"]},{id:"0",names:["General"]}];case 4:return{id:4,username:"User4",isOnline:!0};default:throw new Error("Wrong UserID")}})(a.id);const t=[];e.forEach((e=>{let{id:s,names:r}=e;t.push({id:s,name:v(r,a.username)})})),s({type:"set rooms",payload:t}),s({type:"set current room",payload:"0"})}}),[s,e.rooms,a]);const m=Object(r.useCallback)(((e,s)=>{console.log("?????????????__> "+JSON.stringify(e)),"string"===typeof e&&0!==e.trim().length&&(i||console.error("Couldn't send message"),i.emit("message",{roomId:s,message:e,from:a.id,date:x()(new Date).unix()}))}),[a,i]);return{loading:c,user:a,state:e,dispatch:s,onLogIn:o,onMessageSend:m,onLogOut:d}};var Z=()=>{const{loading:e,user:s,state:t,dispatch:r,onLogIn:a,onMessageSend:o,onLogOut:n}=X();if(e)return Object(c.jsx)(P,{});const i=!s;return window.sessionStorage.setItem("allMessages",JSON.stringify({0:[{from:"1",date:1697094148,message:"There are 10 types of people: those who understand binary and those who don\u2019t",roomId:"0"},{from:"1",date:1697094348,message:"",roomId:"0"},{from:"3",date:1697094548,message:"In a room full of top software designers, if two agree on same thing, that\u2019s a majority.",roomId:"0"},{from:"4",date:1700123793,message:"There are two ways to write error-free programs; only the third one works.\ud83c\udf7e",roomId:"1:4"}],"1:4":[{from:"4",date:1697093948,message:"boss make a dollar; I make a dime; that's why my algorithms run in exponential time",roomId:"0"},{from:"4",date:1697094704,message:"There are two ways to write error-free programs; only the third one works.\ud83c\udf7e",roomId:"1:4"},{from:"1",date:1697094746,message:"A user interface is like a joke. If you have to explain it, it\u2019s not that good \ud83c\udf78",roomId:"1:4"}],"1:2":[{from:"1",date:1697094746,message:"A user interface is like a joke. If you have to explain it, it\u2019s not that good \ud83c\udf78",roomId:"0"},{from:"1",date:1700127951,message:"Before software can be reusable it first has to be usable\ud83e\udd51",roomId:"0"},{from:"1",date:1700127958,message:"If one programmer can do it in one week, then 2 programmers can do it in 2 weeks!",roomId:"0"},{from:"2",date:1700126273,message:"Programming is the art of adding bugs to an empty text file.",roomId:"1:2"}],"2:3":[{from:"3",date:1697094544,message:"I told him I can't open the JAR, and he said go download Java \u2615\ufe0f",roomId:"2:3"},{from:"2",date:1697094585,message:"In order to understand recursion, one must first understand recursion \ud83d\ude0e",roomId:"2:3"}],"2:4":[{from:"4",date:1697094685,message:"A good programmer is someone who always looks both ways before crossing a one-way street.\ud83e\udd5d",roomId:"2:4"},{from:"2",date:1697094738,message:"The trouble is that you can never tell what a programmer is doing until it\u2019s too late.\ud83e\udd57",roomId:"2:4"}],"1:3":[{from:"3",date:1697093948,message:"The computer was born to solve problems that did not exist before.\ud83e\uddc1",roomId:"1:3"},{from:"1",date:1697094704,message:"UNIX is user friendly. It\u2019s just very particular about who its friends are.\ud83e\uddc3",roomId:"1:3"}],"3:4":[{from:"3",date:1697093948,message:"There is an easy way and a hard way. The hard part is finding the easy way. \ud83c\udf61",roomId:"3:4"},{from:"4",date:1697094704,message:"When your hammer is C++, everything begins to look like a thumb.\ud83c\udf4d",roomId:"3:4"}]})),Object(c.jsx)(j.Provider,{value:[t,r],children:Object(c.jsxs)("div",{className:"full-height ".concat(i?"bg-light":""),style:{backgroundColor:i?void 0:"#495057"},children:[Object(c.jsx)(V,{showLogin:i}),i?Object(c.jsx)(l,{onLogIn:a}):Object(c.jsx)(H,{user:s,onMessageSend:o,onLogOut:n})]})})};o.a.render(Object(c.jsx)(Z,{}),document.getElementById("root"))}},[[98,1,2]]]);
//# sourceMappingURL=main.379660a1.chunk.js.map